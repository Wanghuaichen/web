$(function(){function h(a){$("#indicatorTable tbody").empty();$("#indicatorTable tbody").html("");a=listdatatype(a);a=JSON.parse(a);if("success"==a.errCode){a=a.familyList;for(var b=a.length,c=0;c<b;c++){var d=JSON.stringify(a[c]);k(d,c+1,a[c].name,void 0==a[c].poluType?"":a[c].poluType)}sorter.init("indicatorTable",2)}}function k(a,b,c,d){$("#indicatorTable tbody").append("\x3ctr id\x3d'app_"+b+"'\x3e\x3ctd style\x3d'display: none'\x3e"+a+"\x3c/td\x3e\x3ctd style\x3d'width: 6%'\x3e\x3cinput name\x3d'checkbox' class\x3d'nosort' type\x3d'checkbox' id\x3d'checkbox_"+b+"'/\x3e\x3c/td\x3e\x3ctd style\x3d'width: 6%'\x3e"+b+"\x3c/td\x3e\x3ctd\x3e"+c+"\x3c/td\x3e\x3ctd\x3e"+d+"\x3c/td\x3e\x3ctd\x3e\x3ca href\x3d'#' class\x3d'delApp tablelink'\x3e \u5220\u9664\x3c/a\x3e\x3c/td\x3e\x3c/tr\x3e")}function m(a){a.each(function(){var a=JSON.parse($(this).parent().parent().children("td").eq(0).text()),c=a.name,a=a.poluType;$("#indicatorName").val(c);$("#type").val(a);e.dialog("open");e.dialog({title:"\u4fee\u6539\u6307\u6807"});l.text("\u4fee\u6539\u6307\u6807\u4fe1\u606f")})}function n(){var a=$("#addIndicator").dialog("option","title"),b=$("#indicatorName").val().trim(),c=$("#type").val().trim();if(""==b)return $(".confirmMsg").html("\u6307\u6807\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a\uff01"),!1;if(""==c)return $(".confirmMsg").html("\u6307\u6807\u7c7b\u578b\u4e0d\u80fd\u4e3a\u7a7a\uff01"),!1;if("\u6dfb\u52a0\u6307\u6807"==a){a=createdatatype(b,c);a=JSON.parse(a);if("success"!=a.errCode)return alert("\u6dfb\u52a0\u6307\u6807\u4fe1\u606f\u5931\u8d25\uff01"),!1;var d={};d.id=a.poluFamilyId;d.name=b;d.poluType=c;a=JSON.stringify(d);d=$("#indicatorTable tbody tr").length+1;k(a,d,b,c)}}$("#checkAll").click(function(){$(this).is(":checked")?$("input[name\x3d'checkbox']").each(function(){$(this).prop("checked",!0)}):$("input[name\x3d'checkbox']").each(function(){$(this).prop("checked",!1)})});var e,f,g,l=$(".validateTips");e=$("#addIndicator").dialog({autoOpen:!1,height:300,width:530,modal:!0,buttons:[{text:"\u786e\u5b9a",click:function(){n()||e.dialog("close")},"class":"sure"},{text:"\u5173\u95ed",click:function(){e.dialog("close")},"class":"cancel"}]});g=$("#tip").dialog({autoOpen:!1,height:300,width:530,modal:!0,buttons:[{text:"\u786e\u5b9a",click:function(){g.dialog("close")},"class":"sure"}]});f=$("#deltip").dialog({autoOpen:!1,height:300,width:530,modal:!0,buttons:[{text:"\u786e\u5b9a",click:function(a){a=$(this).dialog("option","_button");f.dialog("close");if("del"==a)$("input[type\x3dcheckbox][name\x3dcheckbox]:checked").each(function(){if("checkAll"==$(this).attr("id"))return!0;var a=JSON.parse($(this).parent().parent().children("td").eq(0).text());deletedatatype(a.id);$(this).parent().parent().remove()});else{var b=JSON.parse(a.parent().parent().children("td").eq(0).text());deletedatatype(b.id);a.parent().parent().remove()}},"class":"sure"},{text:"\u53d6\u6d88",click:function(){f.dialog("close")},"class":"cancel"}]});$(".add").click(function(){e.dialog("open");$("#indicatorName").val("");$("#type").val("");$(".confirmMsg").html("");e.dialog("open");e.dialog({title:"\u6dfb\u52a0\u6307\u6807"});l.text("\u6dfb\u52a0\u6307\u6807\u4fe1\u606f")});$(".update").click(function(){$(".confirmMsg").html("");var a=$("input[type\x3dcheckbox][name\x3dcheckbox]:checked").length;0!=a&&1==a?(a=$("input[type\x3dcheckbox][name\x3dcheckbox]:checked"),m(a)):g.dialog("open")});$(".del").click(function(){f.dialog("option","_button","del");f.dialog("open")});$(document).on("click",".delApp",function(){f.dialog("option","_button",$(this));f.dialog("open")});$("#searchType").change(function(){$("#searchType option:selected").text();$("#searchByName").val("")});$("#searchpng").click(function(){var a={},b=$("#searchType option:selected").text();if("\u5168\u90e8"==b)a.all="";else if("\u540d\u79f0"==b){b=$("#searchByName").val().trim();if(""==b)return alert("\u5e94\u7528\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a\uff01"),!1;a.name=b}h(a)});h({all:"yes"})});
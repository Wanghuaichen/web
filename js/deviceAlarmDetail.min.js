/**
 * Created by admin on 2015/11/17.
 */$(function(){function m(){var a={},h={},d={};d.start=(new Date(e)).getTime();d.end=(new Date(g)).getTime();d.space=18E4;h.time=d;h.id=t;h.subId=n;h.devType=q;a.find=h;a=JSON.parse(listhistreport(a));if("success"==a.errCode){var a=a.resultList,h=[],b;for(b in a){var d=a[b].state,f=[];f.push(a[b].time);f.push("on"==d?1:0);h.push(f)}x(r,h)}}function x(a,h,b,e,f){$("#historycontainer").highcharts("StockChart",{chart:{type:a},title:{text:u},xAxis:{type:"datetime",crosshair:!0,endOnTick:!0,showLastLabel:!1,labels:{format:"{value:%Y/%m/%d %H:%M:%S}",rotation:25,align:"left"}},yAxis:{tickPixelInterval:1},tooltip:{headerFormat:"\x3cspan style\x3d'font-size:10px'\x3e{point.key}\x3c/span\x3e\x3ctable\x3e",pointFormatter:function(){return"\x3ctr\x3e\x3ctd style\x3d'color:"+this.series.color+";padding:0'\x3e"+this.series.name+": \x3c/td\x3e\x3ctd style\x3d'padding:0'\x3e"+(1==Number(this.y)?"on":"off")+"\x3c/td\x3e\x3c/tr\x3e"},footerFormat:"\x3c/table\x3e",shared:!0,useHTML:!0,xDateFormat:"%Y/%m/%d %H:%M:%S"},plotOptions:{column:{pointPadding:.2,borderWidth:0}},rangeSelector:{inputDateFormat:"%Y/%m/%d",buttons:[{type:"all",text:"All"}]},series:[{name:"\u72b6\u6001",step:!0,zIndex:1,data:h,marker:{fillColor:"white",lineWidth:2,lineColor:Highcharts.getOptions().colors[0]}}]})}function v(a,b,d,g){a={elem:"#starthour",istime:a,isclear:!1,istoday:!1,format:g,issure:!1,start:b,max:d,choose:function(a){e=a}};e=a.start;return a}function w(a,b,d,e,f){a={elem:"#endhour",istime:a,isclear:!1,istoday:!1,format:f,issure:!1,start:b,min:d,max:e,choose:function(a){g=a}};g=a.start;return a}function k(a,b,d,k){var f="YYYY/MM/DD",c=!1;if("minute"==a||"minute10"==a||"hour"==a)f="YYYY/MM/DD hh:mm:ss",c=!0;b&&(v(c,laydate.now(-2),laydate.now(0),f),w(c,laydate.now(0),e,laydate.now(0),f));d&&laydate(v(c,e,laydate.now(0),f));k&&laydate(w(c,g,e,laydate.now(0),f));$("#starthour").val(e);$("#endhour").val(g)}k("hour",!0);$("#searchType").change(function(){var a=$("#searchType option:selected").val();"minute"==a||"minute10"==a?k("minute"):k("hour")});var g,e;$("#starthour").click(function(){var a=$("#searchType option:selected").val();"minute"==a||"minute10"==a?k("minute",!1,!0):k("hour",!1,!0)});$("#endhour").click(function(){var a=$("#searchType option:selected").val();"minute"==a||"minute10"==a?k("minute",!1,!1,!0):k("hour",!1,!1,!0)});$("#searchpng").click(function(){if(null==g||void 0==g)return alert("\u8bf7\u5148\u9009\u62e9\u65e5\u671f\u8303\u56f4\uff01"),!1;m()});$("#linechart").click(function(){r="line";m()});$("#columnchart").click(function(){r="column";m()});$("#backIndicator").click(function(){setCookie("deviceAlarmBackCurrentPage",y);window.location.href="deviceAlarm.html"});var b=getCookie("deviceAlarm"),y=getCookie("deviceAlarmCurrentPage"),l=getCookie("alarmInfo"),t="",c="",n="",q="",u="",r="line";delCookie("currentPage");delCookie("alarmInfo");if(void 0!=b&&""!=b)if(b=JSON.parse(b),t=b.id,c=b.devId,n=b.subId,u=b.name,c==n)q=b.type;else{var c=b.subs,p;for(p in c){var z=void 0==c[p].type?b.type:c[p].type;n==c[p].pid&&(q=z)}}null!=l&&(l=JSON.parse(l),e=l.startTime,g=l.endTime,$("#starthour").val(e),$("#endhour").val(g));m()});window.applicationCache.status==window.applicationCache.UPDATEREADY&&window.applicationCache.update();
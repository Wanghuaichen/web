$(function(){function e(b){$("#deviceTable tbody").empty();$("#deviceTable tbody").html("");var a={all:""};""!=b&&(a.type=b);a=listdevice(a);listDeviceResponsedata=JSON.parse(a);if("success"==listDeviceResponsedata.errCode){for(var a=listDeviceResponsedata.deviceList,d=a.length,c=0;c<d;c++){var n=JSON.stringify(a[c]);if(a[c].type==b){var k=a[c].name,f=a[c].devId,g=void 0==a[c].org?"":a[c].org,h=void 0==a[c].account?"":a[c].account.name,l=void 0==a[c].connState?"":a[c].connState,l=void 0==l.main?"\u672a\u77e5\u72b6\u6001":l.main,e=JSON.parse(findconnstate(a[c].id)).boxState.version;m(c+1,n,1,k,f,g,h,e,l)}}sorter.init("deviceTable",2);null!=getCookie("backCurrentPage")&&(sorter.transferToPage(Number(getCookie("backCurrentPage"))),delCookie("backCurrentPage"))}}function m(b,a,d,c,e,k,f,g,h){k="detail"+b;d=1==d?"\x3ctd style\x3d'width: 4%'\x3e\x3cinput name\x3d'checkbox' class\x3d'nosort' type\x3d'checkbox' id\x3d'checkbox_"+b+"' checked\x3d'checked' /\x3e\x3c/td\x3e":"\x3ctd style\x3d'width: 4%'\x3e\x3cinput name\x3d'checkbox' class\x3d'nosort' type\x3d'checkbox' id\x3d'checkbox_"+b+"'/\x3e\x3c/td\x3e";$("#deviceTable tbody").append("\x3ctr id\x3d'device_"+b+"'\x3e\x3ctd style\x3d'display: none'\x3e"+a+"\x3c/td\x3e"+d+"\x3ctd style\x3d'width: 6%'\x3e"+b+"\x3c/td\x3e\x3ctd\x3e"+c+"\x3c/td\x3e\x3ctd\x3e"+e+"\x3c/td\x3e\x3ctd\x3e"+f+"\x3c/td\x3e\x3ctd\x3e"+g+"\x3c/td\x3e\x3ctd\x3e"+h+"\x3c/td\x3e\x3c/tr\x3e");$(document).on("click","#"+k,function(){var a=$(this).parent().parent().children("td").eq(0).text();setCookie("deviceselected",a);setCookie("deviceCurrentPage",$("#currentpage").text())})}var d=getCookie("upgradeselected"),p=getCookie("upgradeCurrentPage");setCookie("backCurrentPage",p);$("#checkAll").click(function(){$(this).is(":checked")?$("input[name\x3d'checkbox']").each(function(){$(this).prop("checked",!0)}):$("input[name\x3d'checkbox']").each(function(){$(this).prop("checked",!1)})});$(".update").click(function(){0<$("input[type\x3dcheckbox][name\x3dcheckbox]:checked").length?$("input[type\x3dcheckbox][name\x3dcheckbox]:checked").each(function(){var b=JSON.parse($(this).parent().parent().children("td").eq(0).text()).id;console.log("save id to list "+b)}):console.log("clear id list")});$("#searchType").change(function(){var b=$("#searchType option:selected").val();"all"==b?($("#searchByName").css("display","none"),$("#searchById").css("display","none")):"deviceName"==b?($("#searchByName").css("display","inline"),$("#searchByName").val(""),$("#searchById").css("display","none")):"deviceId"==b&&($("#searchByName").css("display","none"),$("#searchById").css("display","inline"),$("#searchById").val(""))});$("#searchpng").click(function(){var b={},a=$("#searchType option:selected").val();if("all"==a)b.all="",e(b);else{if("deviceName"==a){a=$("#searchByName").val().trim();if(""==a)return alert("\u8bbe\u5907\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a\uff01"),!1;b.name=a}else if("deviceId"==a){a=$("#searchById").val().trim();if(""==a)return alert("\u8bbe\u5907Id\u4e0d\u80fd\u4e3a\u7a7a\uff01"),!1;b.devId=a}$("#deviceTable tbody").find("tr").each(function(){var a=$(this).find("td").eq(3).text(),c=$(this).find("td").eq(4).text();if(b.name==a||b.devId==c){var d=$(this).find("td").eq(0).text(),e=$(this).find("td").eq(1).children("input").is(":checked"),f=$(this).find("td").eq(5).text(),g=$(this).find("td").eq(6).text(),h=$(this).find("td").eq(7).text();$("#deviceTable tbody").empty();$("#deviceTable tbody").html("");m(1,d,e,a,c,"",f,g,h);sorter.init("deviceTable",2)}})}});void 0!=d&&""!=d&&null!=d?(d=JSON.parse(d),$("#name").text(d.name),$("#version").text(d.version),$("#dtype").text(d.dtype),e(d.dtype)):e("")});
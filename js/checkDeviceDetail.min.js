$(function(){function t(){$(".plcState").html("\x3cimg src\x3d'../images/fail.png'\x3e");$(".boxState").html("\x3cimg src\x3d'../images/fail.png'\x3e");$(".ipcState").html("\x3cimg src\x3d'../images/fail.png'\x3e");$(".pcShow").html("\x3cimg src\x3d'../images/pc_alarm.png' width\x3d'125px' height\x3d'87px' alt\x3d'ipc' class\x3d'ipc'\x3e");var a=findconnstate(d.id),a=JSON.parse(a);if("success"==a.errCode){if(void 0!=a.connState&&"noState"!=a.connState){var h=a.connState,b;for(b in h){var c=h[b],e=c.sub,f=void 0==e?"":e.pid,k=void 0==e?"":e.code,e=void 0==c.winccState?"":c.winccState,c=void 0==c.plcState?"":c.plcState,g="\x3ctd class\x3d'plcState'\x3e\x3cimg src\x3d'../images/fail.png'\x3e\x3c/td\x3e",l="\x3ctd class\x3d'pcShow'\x3e\x3cimg src\x3d'../images/pc.png' width\x3d'125px' height\x3d'87px' alt\x3d'ipc'\x3e\x3c/td\x3e",p="\x3ctd class\x3d'boxState'\x3e\x3cimg src\x3d'../images/fail.png'\x3e\x3c/td\x3e",q="\x3ctd class \x3d'ipcState'\x3e\x3cimg src\x3d'../images/fail.png'\x3e\x3c/td\x3e",r={},n={},m={};m.pid=f;m.code=k;""!=e&&void 0!=e&&"noState"!=e&&(l=void 0==e.fs?"":e.fs,n.pcName=void 0==e.pcName?"":e.pcName,n.state=k=void 0==e.state?"":e.state,n.version=void 0==e.version?"":e.version,n.ip=void 0==e.ip?"":e.ip,"on"==l&&(q="\x3ctd class \x3d'ipcState'\x3e\x3cimg src\x3d'../images/ok.png'\x3e\x3c/td\x3e"),l="on"==k?"\x3ctd class\x3d'pcShow'\x3e\x3cimg src\x3d'../images/pc.png' width\x3d'125px' height\x3d'87px' alt\x3d'ipc'\x3e\x3c/td\x3e":"\x3ctd class\x3d'pcShow'\x3e\x3cimg src\x3d'../images/pc_alarm.png' width\x3d'125px' height\x3d'87px' alt\x3d'ipc'\x3e\x3c/td\x3e");""!=c&&void 0!=c&&"noState"!=c&&(m.port=void 0==c.port?"":c.port,m.state=k=void 0==c.state?"":c.state,m.fs=void 0==c.fs?"":c.fs,m.ip=void 0==c.ip?"":c.ip,"on"==k&&(g="\x3ctd class\x3d'plcState'\x3e\x3cimg src\x3d'../images/ok.png'\x3e\x3c/td\x3e"),p="\x3ctd class\x3d'boxState'\x3e\x3cimg src\x3d'../images/ok.png'\x3e\x3c/td\x3e");r.ipc=n;r.plc=m;$(".monitorshow").append("\x3cdiv class\x3d'subDevice'\x3e\x3clabel style\x3d'margin-left:400px;font-size: larger'\x3e"+f+"\x3c/label\x3e\x3ctable align\x3d'center' width\x3d'900px' height\x3d'180px'  style\x3d'background-image: url(../images/dbg.png)'\x3e\x3ctr id\x3d'"+JSON.stringify(r)+"'\x3e\x3ctd\x3e\x3cimg src\x3d'../images/plc.png' width\x3d'80px' height\x3d'35' alt\x3d'plc' class\x3d'plc'\x3e\x3c/td\x3e"+g+"\x3ctd class\x3d'iot'\x3e\x3cimg src\x3d'../images/iot.png' width\x3d'80px' height\x3d'30px' alt\x3d'iot'\x3e\x3c/td\x3e"+p+"\x3ctd\x3e\x3cimg src\x3d'../images/rs-fs.png' width\x3d'100px' height\x3d'70px' alt\x3d'\u4e2d\u8f6c\u670d\u52a1\u5668'\x3e\x3c/td\x3e"+q+l+"\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e")}}h=a.boxState;void 0!=h&&"noState"!=h&&(b=void 0==h.version?"":h.version,a=void 0==h.lan?"":h.lan,g=void 0==h.wan?"":h.wan,h=void 0==g.gw?"":g.gw,f=void 0==g.dns1?"":g.dns1,e=void 0==g.dns2?"":g.dns2,c=void 0==g.mask?"":g.mask,g=void 0==g.ip?"":g.ip,p=void 0==a.gw?"":a.gw,q=void 0==a.mask?"":a.mask,a=void 0==a.ip?"":a.ip,$("#lantable tbody").append("\x3ctr id\x3d'landetail_1'\x3e\x3ctd\x3e1\x3c/td\x3e\x3ctd\x3e"+a+"\x3c/td\x3e\x3ctd\x3e"+q+"\x3c/td\x3e\x3ctd\x3e"+p+"\x3c/td\x3e\x3c/tr\x3e"),$("#wantable tbody").append("\x3ctr id\x3d'wandetail_1'\x3e\x3ctd\x3e1\x3c/td\x3e\x3ctd\x3e"+(""==g?"\u672a\u8fde\u63a5":"\u5df2\u8fde\u63a5")+"\x3c/td\x3e\x3ctd\x3e"+g+"\x3c/td\x3e\x3ctd\x3e"+c+"\x3c/td\x3e\x3ctd\x3e"+h+"\x3c/td\x3e\x3ctd\x3e"+(""==f?e:""==e?"":f+"/"+e)+"\x3c/td\x3e\x3c/tr\x3e"),$("#boxVersion").text(b))}}function u(){for(var a=0;a<l.length;a++){var b=l[a].pid,d=l[a].code,c=void 0==l[a].type?"":l[a].type;$("#childDevice tbody").append("\x3ctr id\x3d'plcdetail_"+a+"'\x3e\x3ctd\x3e"+(a+1)+"\x3c/td\x3e\x3ctd\x3e"+b+"\x3c/td\x3e\x3ctd\x3e"+d+"\x3c/td\x3e\x3ctd\x3e"+c+"\x3c/td\x3e\x3c/tr\x3e")}}var b=getCookie("deviceselected"),f=getCookie("deviceCurrentPage");setCookie("backCurrentPage",f);var v=$("#ipcdialog").dialog({autoOpen:!1,height:450,width:530,modal:!0}),w=$("#iotdialog").dialog({autoOpen:!1,height:450,width:650,modal:!0});$(document).on("click",".pcShow",function(){v.dialog("open");$("#ipctable tbody").html("");$("#ipctable tbody").empty();var a=JSON.parse($(this).parent().attr("id")).ipc,b=void 0==a.pcName?"":a.pcName,d=void 0==a.state?"":a.state,c=void 0==a.version?"":a.version,a=void 0==a.ip?"":a.ip;$("#ipctable tbody").append("\x3ctr id\x3d'plcdetail_1'\x3e\x3ctd\x3e1\x3c/td\x3e\x3ctd\x3e"+b+"\x3c/td\x3e\x3ctd\x3e"+a+"\x3c/td\x3e\x3ctd\x3e"+d+"\x3c/td\x3e\x3c/tr\x3e");$("#ipcVersion").text(c)});$(document).on("click",".iot",function(){w.dialog("open");$("#plctable tbody").html("");$("#plctable tbody").empty();var a=JSON.parse($(this).parent().attr("id")).plc,b=void 0==a.port?"":a.port,d=void 0==a.ip?"":a.ip,c=void 0==a.pid?"":a.pid,a=void 0==a.code?"":a.code;$("#plctable tbody").append("\x3ctr id\x3d'plcdetail_1'\x3e\x3ctd\x3e1\x3c/td\x3e\x3ctd\x3e"+c+"\x3c/td\x3e\x3ctd\x3e"+a+"\x3c/td\x3e\x3ctd\x3e"+d+"\x3c/td\x3e\x3ctd\x3e"+b+"\x3c/td\x3e\x3c/tr\x3e")});$("#lantable tbody").html("");$("#lantable tbody").empty();$("#wantable tbody").html("");$("#wantable tbody").empty();$("#childDevice tbody").html("");$("#childDevice tbody").empty();if(void 0!=b&&""!=b&&null!=b){var d=JSON.parse(b),f=d.name,k=void 0==d.devId?"":d.devId,x=void 0==d.code?"":d.code,y=d.org,z=void 0==d.k37sn?"":d.k37sn,A=d.location.province+d.location.city+d.location.district+d.location.address,b=d.account.uid,B=d.desc,l=d.subs;$("#deviceName").text(f);$("#deviceId").text(k);$("#deviceCode").text(x);$("#factoryName").text(y);$("#factoryAddress").text(A);$("#k37sn").text(z);$("#desc").text(B);void 0!=d.wcard&&(f=d.wcard,$("#cardNum").text(f.number),$("#cardExpire").text(f.expire));void 0!=b&&(f={},f.userId=b,b=listuser(f),b=JSON.parse(b),"success"==b.errCode&&1==b.total&&(k=b.accountList[0],b=k.org,f=k.userName,k=k.mobile,$("#customer").text(b+"/"+f),$("#tel").text(k)));t();void 0!=l&&u()}900<$(".monitorshow").width()?$(".subDevice").css({"margin-left":($(".monitorshow").width()-900)/2}):"";$(window).height()-290>$(".monitorshow").height()?$(".monitorshow").css({height:$(window).height()-290}):"";$(window).resize(function(){900<$(".monitorshow").width()?$(".subDevice").css({"margin-left":($(".monitorshow").width()-900)/2}):"";$(window).height()-290>$(".monitorshow").height()?$(".monitorshow").css({height:$(window).height()-290}):""})});window.applicationCache.status==window.applicationCache.UPDATEREADY&&window.applicationCache.update();